name: aws
runtime: nodejs22.x
architecture: arm64
region: us-east-1
environment:
  COGNITO_CLIENT_ID: !Ref UserPoolClient
  COGNITO_POOL_ID: !Ref UserPool
httpApi:
  authorizers:
    CognitoAuthorizer:
      type: jwt
      identitySource: $request.header.Authorization
      issuerUrl: !GetAtt UserPool.ProviderURL
      audience:
        - !Ref UserPoolClient
iam:
  role:
    statements:
      - Effect: Allow
        Action:
          - cognito-idp:AdminGetUser
          - cognito-idp:CreateGroup
          - cognito-idp:ListGroups
          - cognito-idp:DeleteGroup
          - cognito-idp:UpdateGroup
          - cognito-idp:AdminAddUserToGroup
          - cognito-idp:ListUsersInGroup
          - cognito-idp:ListUsersInGroup
          - cognito-idp:AdminRemoveUserFromGroup
        Resource: !GetAtt UserPool.Arn
